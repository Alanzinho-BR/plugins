package br.com.piracraft.lobby.menu;

import java.util.HashMap;

import org.bukkit.Bukkit;
import org.bukkit.Material;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.inventory.InventoryClickEvent;
import org.bukkit.inventory.Inventory;

import br.com.piracraft.api.PiraCraftAPI;
import br.com.piracraft.api.caixas.ItemAPI;
import br.com.piracraft.lobby.utils.Cor;
import br.com.piracraft.lobby.utils.LobbyAPI;

public class SkywarsMenu implements Listener {

	private static Inventory menu = Bukkit.createInventory(null, 45,
			"§aSkyWars");

	public static void updateMenu() {
		for (int i = 0; i < 10; i++) {
			menu.setItem(i, ItemAPI.Criar(Material.STAINED_GLASS_PANE, 1, 15,
					" ", false));
		}
		menu.setItem(17,
				ItemAPI.Criar(Material.STAINED_GLASS_PANE, 1, 15, " ", false));
		menu.setItem(18,
				ItemAPI.Criar(Material.STAINED_GLASS_PANE, 1, 15, " ", false));
		menu.setItem(20,
				ItemAPI.Criar(Material.INK_SACK, 1, 1, "§6§lEntrar no Jogo",
						false, " ", "§7Click para conectar rapidamente",
						"§7a uma sala disponivel de skywars."));
		menu.setItem(26,
				ItemAPI.Criar(Material.STAINED_GLASS_PANE, 1, 15, " ", false));
		menu.setItem(27,
				ItemAPI.Criar(Material.STAINED_GLASS_PANE, 1, 15, " ", false));
		menu.setItem(24, ItemAPI.Criar(Material.IRON_BLOCK, 1, 15,
				"§6§lTodas as Salas", false, " ", "§7Em desenvolvimento."));
		for (int i = 35; i < 45; i++) {
			menu.setItem(i, ItemAPI.Criar(Material.STAINED_GLASS_PANE, 1, 15,
					" ", false));
		}

	}

	public static void open(Player player) {
		player.openInventory(menu);
	}

	@EventHandler
	public void click(InventoryClickEvent event) {
		Player player = (Player) event.getWhoClicked();
		if (event.getInventory().getName().equalsIgnoreCase("§aSkyWars")
				&& (event.getCurrentItem() != null)) {
			event.setCancelled(true);
			if (event.getCurrentItem().getType() == Material.INK_SACK) {
				HashMap<String, Object> salaInfo = PiraCraftAPI
						.getFirstSkywarsRoomOpened();
				if (!salaInfo.isEmpty()) {
					String server = (String) salaInfo.get("NOME_BUNGEECORD");
					LobbyAPI.enviarAlertaPlayer(player, "SkyWars",
							"Voce esta sendo enviado para " + server,
							Cor.Verde);
					LobbyAPI.enviar(player, server);

				} else {
					//
					
				}

			}
		}

	}

}
