package me.douglasamv.hg.Manager;

import java.text.SimpleDateFormat;
import java.util.Random;

import org.bukkit.Bukkit;
import org.bukkit.Location;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.EventPriority;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerTeleportEvent;
import org.bukkit.event.server.ServerListPingEvent;

import me.douglasamv.hg.Main;
import me.douglasamv.hg.Timer.StringTimer;

public class IniciandoEvt implements Listener {

	public static boolean Teleportar;

	@EventHandler
	public void onTeleport(PlayerTeleportEvent e) {
		if (Teleportar) {
			e.setCancelled(true);
		}
	}

	@EventHandler(priority = EventPriority.MONITOR)
	public void onPing(ServerListPingEvent e) {
		if (Main.PreGame) {
			e.setMotd("§aAguardando jogadores!\n§7Inicia em §c»§f " + StringTimer.TimerGame(Main.TimerIniciando));
		}
		if (Main.PreInvencibilidade) {
			e.setMotd("§cPartida em progresso!\n§7Invencibilidade acaba em §c»§f "
					+ StringTimer.TimerGame(Main.TimerInvencibilidade));
		}
		if (Main.Partida) {
			int millis = Main.Andamento * 1000;
			SimpleDateFormat df = new SimpleDateFormat("mm:ss");
			String time = df.format(Integer.valueOf(millis));
			e.setMotd("§cPartida em progresso!\n§7Tempo de partida §c»§f " + time);
		}
		if (Main.Finalizando) {
			e.setMotd("§cServidor reiniciando!");
		}
	}

	public static void onTeleport() {
		for (Player p : Bukkit.getOnlinePlayers()) {
			if (Main.Jogadores.contains(p.getName())) {
				int x = new Random().nextInt(5) + 30;
				int y = new Random().nextInt(5) + 90;
				int z = new Random().nextInt(5) + 30;
				Location loc = new Location(p.getWorld(), x, y, z);
				p.teleport(loc);
			}
		}
	}
}